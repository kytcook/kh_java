<%@ page language="java" contentType="application/json; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="java.util.List, java.util.Map, java.util.ArrayList" %>
<%@ page import="java.util.HashMap% %>
<%@ page import="com.util.DBConnectionMgr, java.sql.Connection" %>
<%@ page import="java.sql.PreparedStatement, java.sql.ResultSet" %>
<%
		//스크립트
		Connection con = null;
		PreparedStatement pstmt = nill;
		ResultSet rs = null;
		DBConnectionMgr dbMgr = new DBConnectionMgr();
		List<Map<String,Object>> deptList = null;
		try {
			con = DriverManager.getConnection(_URL,_USER,_PW);
			// 파라미터로 받은 select문을 전달
			pstmt = con.prepareStatement("SELECT deptno, dname, loc FROM dept");
			// 전달 된 select문에 대한 처리를 요청하고 커서 받아내기
			rs = pstmt.executeQuery();
			deptList = new ArrayList<>();
			Map<String, Object> rmap = null;
			while(rs.next()) {
				rmap = new HashMap<>();
				rmap.put("deptno", rs.getInt("deptno"));
				rmap.put("dname", rs.getString("dname"));
				rmap.put("loc", rs.getString("loc"));
				deptList.add(rmap);
			}
			//System.out.println(con+"생성 되어나요?");
			if(deptList == null || deptList.size() < 1) {
				JOptionPane.showMessageDialog(this,"데이터가 없습니다.","Info" ,JOptionPane.INFORMATION_MESSAGE);
				return deptList;
			}
		
		
%>